define(["media_videojs/video-lazy"],function(a){a.plugin("playlist",function(a){var b,c=this.el().id,d=document.getElementById(c).className;b=d.indexOf("fms")!=-1?".m38u":"/playlist.m3u8";for(var e=document.querySelectorAll("#"+c+"-vjs-playlist .vjs-track"),f=e.length,g=this,h=!0,i=a.onTrackSelected,j=0;j<f;j++)e[j].onclick=function(){k(this)};var k=function(a){for(var c=a.getAttribute("data-src"),d=g.remoteTextTracks(),j=0;j<d.length;j++)g.removeRemoteTextTrack(d[j]);var k=new Object;if(k.kind="captions",k.mode="showing",k.label="english",k.srclang="en",k["default"]=!0,c.indexOf(".mp4")!=-1){var l=c.replace("rtmp","https");l=l.replace("&mp4","_definst_/mp4"),l=l.replace(".mp4",".mp4"+b),g.src([{type:"rtmp/mp4",src:c},{type:"video/mp4",src:l}]);var m=l.replace("mp4:","");m=m.replace("mp4"+b,"vtt"),k.src=m,g.addRemoteTextTrack(k)}else if(c.indexOf(".flv")!=-1){g.src([{type:"rtmp/x-flv",src:c}]);var m=c.replace("rtmp","https");m=m.replace("&flv:","_definst_/"),m=m.replace(".flv",".vtt"),k.src=m,g.addRemoteTextTrack(k)}else if(c.indexOf(".f4v")!=-1){var l=c.replace("rtmp","https");l=l.replace("&mp4","_definst_/mp4"),l=l.replace(".f4v",".f4v"+b),g.src([{type:"rtmp/mp4",src:c},{type:"video/mp4",src:l}]);var m=l.replace("mp4:","");m=m.replace("f4v"+b,"vtt"),k.src=m,g.addRemoteTextTrack(k)}else if(c.indexOf(".mp3")!=-1){var l=c.replace("rtmp","https");l=l.replace("&mp3","_definst_/mp3"),l=l.replace(".mp3",".mp3"+b),g.src([{type:"rtmp/mp3",src:c},{type:"audio/mp3",src:l}]);var m=l.replace("mp3:","");k.src=m,g.addRemoteTextTrack(k)}h&&g.play();for(var j=0;j<f;j++)e[j].className.indexOf("currentTrack")!==-1&&(e[j].className=e[j].className.replace(/\bcurrentTrack\b/,"nonPlayingTrack"));a.className=a.className+" currentTrack","function"==typeof i&&i.apply(a)}});var b=document.getElementsByClassName("video-playlist");if(b.length>0)for(var c=0;c<b.length;c++){var d=b[c].id;a(d,{}).ready(function(){function a(){var a=document.getElementById(b.el().id).parentElement.offsetWidth,c=8/12;b.width(a).height(a*c)}var b=this;b.playlist({continuous:!1}),a(),window.onresize=a})}});