define(["media_videojs/video-lazy"],function(a){return{initialize:function(b){a.plugin("playlist",function(a){for(var c=this.el().id,d=document.querySelectorAll("#"+c+"-vjs-playlist .vjs-track"),e=d.length,f=this,g=!0,h=a.onTrackSelected,i=0;i<e;i++)d[i].onclick=function(){j(this)};var j=function(a){var c=a.getAttribute("data-src");if("1"==b.defaultcc){for(var i=f.remoteTextTracks(),j=0;j<i.length;j++)f.removeRemoteTextTrack(i[j]);var k=new Object;k.kind="captions",k.mode="showing",k.label="english",k.srclang="en",k["default"]=!0}if(c.indexOf(".mp4")!=-1){if("1"==b.hlsfallback){var l=c.replace("rtmp",b.httprotocol);l=b.hlsurl.indexOf("playlist")!=-1?l.replace("&","_definst_/"):l.replace("&",""),l=l.replace(".mp4",".mp4"+b.hlsurl),f.src([{type:"rtmp/mp4",src:c},{type:"video/mp4",src:l}])}else f.src([{type:"rtmp/mp4",src:c}]);if("1"==b.defaultcc){var m=c.replace("rtmp",b.httprotocol);if(m=m.replace(".mp4",".vtt"),b.hlsurl.indexOf("playlist")!=-1)m=m.replace("&","_definst_/");else{m=m.replace("&","");var n=/(\/[^\/]*\.vtt$)/i;m=m.replace(n,"/vtt$1")}k.src=m,f.addRemoteTextTrack(k)}}else if(c.indexOf(".flv")!=-1){if(f.src([{type:"rtmp/x-flv",src:c}]),"1"==b.defaultcc){var m=c.replace("rtmp",b.httprotocol);if(m=m.replace(".flv",".vtt"),b.hlsurl.indexOf("playlist")!=-1)m=m.replace("&","_definst_/");else{m=m.replace("&","");var n=/(\/[^\/]*\.vtt$)/i;m=m.replace(n,"/vtt$1")}k.src=m,f.addRemoteTextTrack(k)}}else if(c.indexOf(".f4v")!=-1){if("1"==b.hlsfallback){var l=c.replace("rtmp",b.httprotocol);l=b.hlsurl.indexOf("playlist")!=-1?l.replace("&","_definst_/"):l.replace("&",""),l=l.replace(".f4v",".f4v"+b.hlsurl),f.src([{type:"rtmp/mp4",src:c},{type:"video/mp4",src:l}])}else f.src([{type:"rtmp/mp4",src:c}]);if("1"==b.defaultcc){var m=c.replace("rtmp",b.httprotocol);if(m=m.replace(".f4v",".vtt"),b.hlsurl.indexOf("playlist")!=-1)m=m.replace("&","_definst_/");else{m=m.replace("&","");var n=/(\/[^\/]*\.vtt$)/i;m=m.replace(n,"/vtt$1")}k.src=m,f.addRemoteTextTrack(k)}}else if(c.indexOf(".mp3")!=-1){if("1"==b.hlsfallback){var l=c.replace("rtmp",b.httprotocol);l=b.hlsurl.indexOf("playlist")!=-1?l.replace("&","_definst_/"):l.replace("&",""),l=l.replace(".mp3",".mp3"+b.hlsurl),f.src([{type:"rtmp/mp4",src:c},{type:"video/mp4",src:l}])}else f.src([{type:"rtmp/mp4",src:c}]);if("1"==b.defaultcc){var m=c.replace("rtmp",b.httprotocol);if(m=m.replace(".mp3",".vtt"),b.hlsurl.indexOf("playlist")!=-1)m=m.replace("&","_definst_/");else{m=m.replace("&","");var n=/(\/[^\/]*\.vtt$)/i;m=m.replace(n,"/vtt$1")}k.src=m,f.addRemoteTextTrack(k)}}g&&f.play();for(var j=0;j<e;j++)d[j].className.indexOf("currentTrack")!==-1&&(d[j].className=d[j].className.replace(/\bcurrentTrack\b/,"nonPlayingTrack"));a.className=a.className+" currentTrack","function"==typeof h&&h.apply(a)}});var c=document.getElementsByClassName("video-playlist");if(c.length>0)for(var d=0;d<c.length;d++){var e=c[d].id;a(e,{}).ready(function(){function a(){var a=document.getElementById(b.el().id).parentElement.offsetWidth,c=8/12;b.width(a).height(a*c)}var b=this;b.playlist({continuous:!1}),a(),window.onresize=a})}}}});